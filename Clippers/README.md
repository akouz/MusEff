# Клипперы

В примочках Overdrive и Distortion часто используются клипперы, сделанные на встречно-параллельных диодах. Пример простейшего клиппера:

<img width="381" height="181" alt="diodes" src="https://github.com/user-attachments/assets/de00f680-831b-440a-ba8e-14080d3fb426" /> 

Fig.1

Хорошо известно, что диоды разного типа дают существенно разное звучание: кремниевые диоды создат жесткое звучание с обилием высоких гармоник, германиевые - мягкое звучание, отчасти напоминающее звучание ламповых усилителей, а диоды Шоттки находятся где-то посередине. Однако природа этих отличий до сих пор мало кому известна. Люди проводят обширные исследования ВАХ диодов, но суть от них ускользает. Понять почему германиевые диоды звучат не так как Шоттки и кремниевые практически невозможно по одним только "голым" ВАХ или передаточным характеристикам клиппера. 

Интересные явления открываются если посмотреть на первую производную передаточных характеристик клипперов с разными диодами. 

Вот передаточные характеристики клипперов на германиевых диодах (красная и синяя линии), плюс их производные (зеленые линии): 

<img width="512" height="383" alt="1N34A_1N270" src="https://github.com/user-attachments/assets/3ef8f0bb-2584-4ae4-8636-138791d0f24a" />

Fig.2

А вот передаточные характеристики и их производные для кремниевых диодов:

<img width="507" height="486" alt="1N4148_1N4001" src="https://github.com/user-attachments/assets/953d7224-80c3-4989-96e6-4c9e9c57d3c8" />

Fig.3

Хорошо видно, что начальный участок передаточных характеристик кремниевых клипперов практически линеен. Диоды закрыты и до какого-то порогового напряжения не вносят искажений. Но после этого порога, при напряжениях более 0.35...0.4 В, передаточные характеристики кремниевых клипперов становятся подобны передаточным характеристикам германиевых. 

Таким образом, суть отличия "германиевой" передаточной характеристики от "кремниевой" состоит в том, что "германиевая" нелинейна везде, на всем своем протяжении, тогда как "кремниевая" сочетает линейный и нелинейный участки. Монотонно нелинейная передаточная характеристика дает мягкое звучание, без неприятных призвуков ("песка").

Соответственно, звучание клипперов на диодах Шоттки все же остается "кремниевым", поскольку клиппер имеет линейный участок в передаточной характеристике, хоть он и меньше, чем в клиппере на обычных кремниевых диодах. Этот линейный участок дополнительно можно уменьшить, если нагреть диоды Шиттки до 100...120 С. Эксперимент показал, что звучание клиппера при этом смягчается и становится еще более похожим на звучание германиевого клиппера, однако полностью избавиться от "кремниевого хрипа" не удалось.

## Клипперы со смещением

Из этого следует, что если кремниевые диоды в клиппере "сдвинуть влево", подав на них небольшое положительное смещение, то их передаточные характеристики станут такиме же, как у германиевых клипперов. Звучать они будут одинаково. Нужное напряжение смещения можно получить, если через опорный диод пропустить небольшой ток, а получившееся на нем падение напряжения буферизовать и использовать как напряжение смещения для клиппера. Для диодов 1N4148 передаточные характеристики при токах смещения опорного диода 10 мкА и 20 мкА таковы:

<img width="494" height="389" alt="1N4148_biased" src="https://github.com/user-attachments/assets/5fb49fee-d8b9-488f-b19d-d0b518f60f0e" />

Fig.4

Как видим, теперь отличий от германиевых клипперов практически нет. Один из вариантов схемы клиппера на кремниевых диодах со смещением выглядит так:

<img width="256" height="393" alt="Clipper_biased" src="https://github.com/user-attachments/assets/d2e3a353-9987-40f4-8cfc-9a9de3d527b9" />

Fig.5

Клиппер со смещением можно также собрать на двух ОУ. В этом случае величину смещения можно плавно регулировать подстроечником.

<img width="513" height="395" alt="OpAmp_bias" src="https://github.com/user-attachments/assets/711b506a-9da6-444e-b216-dc0ae94e17fe" />

Fig.6

## Клипперы с подмесом ВЧ сигнала

Есть и другая возможность получить плавную передаточную характеристику клиппера. Если на диоды кремниевого клиппера подать треугольный ВЧ сигнал с амплитудой, соответствующей напряжению смещения, то диоды немного приоткроются. Выходной сигнал клиппера затем нужно отфильтровать при помощи пассивного ФНЧ. Характеристики этого клиппера на диодах 1N4148 таковы:

<img width="505" height="447" alt="1N4148_with RF" src="https://github.com/user-attachments/assets/0118f866-c9ee-40e2-b689-a07d78b60c4b" />

Fig.7

Артефакты в начале графика производной вызваны переходными процессами в использованном ФНЧ 3-го порядка, а также неидеальностью использованного дифференциатора, при помощи которого вычислялась производная. 

Для наглядности приведем характеристики клиппера, в котором в качестве диодов использованы транзисторы 2N2222. Красная линия - без подмеса ВЧ, зеленая - с подмесом. Как видим, с подмесом ВЧ передаточная характеристика сгладилась и на большом участке стала описываться квадратичной функцией, поскольку ее производная линейна. 

<img width="516" height="394" alt="2N2222_with_without_RF" src="https://github.com/user-attachments/assets/0773ff9a-c0ce-46e1-9006-c7e35b1be2f8" />

Fig.8

Степенными функциями описываются передаточные характеристики триодных ламповых каскадов. Создаваемые ими искажения имеют быстро затухающий спектр. 

Возьмем источник треугольного напряжения с размахом от -1 В до +1 В и частотой, скажем, 200 кГц. Смешаем его 1:1 со входным сигналом и подадим на идеальный клиппер, который обрежет сигнал на уровнях -1 В и +1 В. Выходной сигнал пропустим через ФНЧ 2...4 порядка с частотой среза 7 кГц.

При нулевом входном сигнале на выходе ФНЧ получится 0, треугольник не обрезан клиппером, зато практически полностью подавлен фильтром. При увеличении входного напряжения вершинки треугольника будут все больше обрезаться клиппером. ФНЧ будет усреднять получившийся сигнал, рассчитывая площадь трапеций при напряжении больше нуля минус площадь треугольников при напряжении меньше нуля. По мере роста входного сигнала напряжение на выходе будет расти все медленнее, а при входном напряжении +2 В напряжение на выходе достигнет +1 В и больше расти не будет. При уменьшении входного напряжения меньше нуля будут зеркально происходить те же процессы, при напряжении на входе -2 В напряжение на выходе достигнет -1 В и более уменьшаться не будет.

<img width="479" height="377" alt="transfer" src="https://github.com/user-attachments/assets/8e7f3c32-5f33-432a-a13a-700d7e4045aa" />

Fig.9

Передаточная характеристика получившегося мягкого клиппера на участке от X=-2 В до X=+2 В  описывается формулами 

$`X - X^2/4`$ 

для положительных напряжений и 

$`X + X^2/4`$ 

для отрицательных.

Если на мягкий клиппер с такой передаточной характеристикой подавать синусоидальный сигнал, то искажения на выходе будут расти более-менее пропорционально входному сигналу:

* 0.44% при 200 mV p-p
* 0.89% при 400 mV p-p
* 1.88% при 800 mV p-p
* 4.13% при 1.6 V p-p
* 10.1% при 3.2 V p-p
  
При напряжении 4 V p-p искажения достигают 15%. После этого начинается более жесткое клиппирование.


